(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{508:function(t,a,s){"use strict";s.r(a);var e=s(43),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("在 Mac 上安装 Tesseract 的踩坑记录。")]),t._v(" "),s("h2",{attrs:{id:"资料"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#资料"}},[t._v("#")]),t._v(" 资料")]),t._v(" "),s("p",[t._v("Tesseract 是一个开源的 OCR 引擎：")]),t._v(" "),s("ul",[s("li",[t._v("Github: "),s("a",{attrs:{href:"https://github.com/tesseract-ocr/tesseract",target:"_blank",rel:"noopener noreferrer"}},[t._v("tesseract-ocr/tesseract")])]),t._v(" "),s("li",[t._v("文档："),s("a",{attrs:{href:"https://tesseract-ocr.github.io/tessdoc/",target:"_blank",rel:"noopener noreferrer"}},[t._v("tesseract-ocr.github.io/tessdoc")])])]),t._v(" "),s("h2",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[t._v("#")]),t._v(" 安装")]),t._v(" "),s("h3",{attrs:{id:"直接安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#直接安装"}},[t._v("#")]),t._v(" 直接安装")]),t._v(" "),s("p",[t._v("文档给了"),s("a",{attrs:{href:"https://tesseract-ocr.github.io/tessdoc/Home.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("直接安装")]),t._v("和"),s("a",{attrs:{href:"https://tesseract-ocr.github.io/tessdoc/Compiling.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("编译源码")]),t._v("两种安装方式，在 Mac 上的确可以用 "),s("code",[t._v("brew")]),t._v(" 来直接安装：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("brew "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" tesseract\n")])])]),s("p",[t._v("但这是在你只需要用现成的语言库，不需要自行训练的前提下。如果要用 Tesseract 来训练，那就要装 training tools，不然有的命令（如 "),s("code",[t._v("unicharset_extractor")]),t._v("）就没法用。")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://stackoverflow.com/questions/36304824/unicharset-extractor-command-not-found",target:"_blank",rel:"noopener noreferrer"}},[t._v("这个回答")]),t._v("说可以直接通过 "),s("code",[t._v("brew")]),t._v(" 的 "),s("code",[t._v("--with-training-tools")]),t._v(" 选项来装 training tools：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("brew "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --with-training-tools tesseract\n")])])]),s("p",[t._v("但这是个四年前的回答，而 Tesseract 在两年前就移除了所有的选项（见 "),s("a",{attrs:{href:"https://github.com/Homebrew/homebrew-core",target:"_blank",rel:"noopener noreferrer"}},[t._v("Homebrew/homebrew-core")]),t._v(" 的 "),s("a",{attrs:{href:"https://github.com/Homebrew/homebrew-core/pull/36293",target:"_blank",rel:"noopener noreferrer"}},[t._v("pr#36293")]),t._v(" 和 "),s("a",{attrs:{href:"https://github.com/Homebrew/homebrew-core/pull/31510",target:"_blank",rel:"noopener noreferrer"}},[t._v("pr#31510")]),t._v("）。那么就只能通过编译源码来安装。")]),t._v(" "),s("h3",{attrs:{id:"编译源码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#编译源码"}},[t._v("#")]),t._v(" 编译源码")]),t._v(" "),s("p",[t._v("主要参考：")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://tesseract-ocr.github.io/tessdoc/Compiling.html#macos-with-homebrew",target:"_blank",rel:"noopener noreferrer"}},[t._v("Compilation guide for various platforms")])]),t._v(" "),s("li",[s("a",{attrs:{href:"https://tesseract-ocr.github.io/tessdoc/TrainingTesseract-4.00#on-macos-mojave-with-homebrew",target:"_blank",rel:"noopener noreferrer"}},[t._v("How to use the tools provided to train Tesseract 4.00")])])]),t._v(" "),s("p",[t._v("去"),s("a",{attrs:{href:"https://github.com/tesseract-ocr/tesseract/releases/tag/4.1.1",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里")]),t._v("下源码，然后安装一些依赖包：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("brew "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" cairo pango icu4c autoconf libffi libarchive\n")])])]),s("p",[t._v("如果缺了这些包，在安装 training tools 的时候就会报：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("Need to reconfigure project, so there are no errors\n")])])]),s("p",[t._v("然后按"),s("a",{attrs:{href:"https://tesseract-ocr.github.io/tessdoc/Compiling.html#compile",target:"_blank",rel:"noopener noreferrer"}},[t._v("文档")]),t._v("来就行：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" tesseract  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 下载的源码路径")]),t._v("\n./autogen.sh\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" build\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" build\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 配置环境变量")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/configure "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PKG_CONFIG_PATH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local/opt/icu4c/lib/pkgconfig:/usr/local/opt/libarchive/lib/pkgconfig:/usr/local/opt/libffi/lib/pkgconfig\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 编译 Tesseract")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" -j\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装 Tesseract")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 编译 training tools")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" training\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装 training tools")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" training-install\n")])])]),s("p",[t._v("当然配置环境变量那一步也可以按"),s("a",{attrs:{href:"https://tesseract-ocr.github.io/tessdoc/TrainingTesseract-4.00#on-macos-mojave-with-homebrew",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里")]),t._v("写的那样等价替换为：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PKG_CONFIG_PATH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),t._v("brew --prefix"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("/lib/pkgconfig:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),t._v("brew --prefix"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("/opt/libarchive/lib/pkgconfig:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),t._v("brew --prefix"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("/opt/icu4c/lib/pkgconfig:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),t._v("brew --prefix"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("/opt/libffi/lib/pkgconfig\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/configure\n")])])]),s("h3",{attrs:{id:"环境变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#环境变量"}},[t._v("#")]),t._v(" 环境变量")]),t._v(" "),s("p",[s("code",[t._v("TESSDATA_PREFIX")]),t._v(" 是存放 Tesseract 训练好的语言数据的路径，它的默认值大概是 "),s("code",[t._v("/usr/local/share/tessdata")]),t._v("，不出意外地话这个路径在安装完 Tesseract 后就会出现。但如果你想换个路径，那就需要去配环境变量：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("TESSDATA_PREFIX")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("your_path_to_tessdata_dir"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("\n")])])]),s("p",[t._v("Shell 是 bash 就在 "),s("code",[t._v("~/.bash_profile")]),t._v(" 里配，是 zsh 就在 "),s("code",[t._v("~/.zshrc")]),t._v(" 里配。然后：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" ~/.bash_profile\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或 ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" ~/.zshrc\n")])])]),s("p",[t._v("可以去"),s("a",{attrs:{href:"https://github.com/tesseract-ocr/tessdata",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里")]),t._v("下载已经训练好的语言数据，或者自己训练一些，总之得把语言数据（"),s("code",[t._v("*.traineddata")]),t._v("）放到路径 "),s("code",[t._v("TESSDATA_PREFIX")]),t._v(" 下才能用。如果 Tesseract 在 "),s("code",[t._v("TESSDATA_PREFIX")]),t._v(" 下找不到你要用的语言数据，或者 "),s("code",[t._v("TESSDATA_PREFIX")]),t._v(" 这个路径不存在，都会报：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("Please "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" sure the TESSDATA_PREFIX environment variable is "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" to your "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tessdata"')]),t._v(" directory.\n")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);